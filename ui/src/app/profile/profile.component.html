<div class="profile-card mx-auto my-5">
  <h2>My Profile</h2>

  <div *ngIf="successMessage" class="alert alert-success">
    {{ successMessage }}
  </div>
  <div *ngIf="errorMessage" class="alert alert-danger">
    {{ errorMessage }}
  </div>

  <div class="avatar-wrapper">
    <img
      [src]="
        user.url
          ? user.url
          : 'https://ui-avatars.com/api/?name=' +
            (user.name || 'User') +
            '&background=556272&color=ffffff&size=120&rounded=true'
      "
      alt="User avatar"
      class="avatar"
    />
  </div>

  <!-- Profile update form (excludes password) -->
  <form #profileForm="ngForm" (ngSubmit)="update()" novalidate>
    <div class="field-group mb-3">
      <label>Email</label>
      <div class="readonly-text">{{ user.email }}</div>
    </div>

    <div class="field-group mb-3">
      <label for="name">Username</label>
      <input
        id="name"
        name="name"
        type="text"
        [(ngModel)]="user.name"
        class="input"
        [disabled]="loading"
      />
    </div>

    <div class="field-group mb-4">
      <label for="website">Website</label>
      <input
        id="website"
        name="website"
        type="url"
        [(ngModel)]="user.website"
        class="input"
        [disabled]="loading"
      />
    </div>

    <button
      type="submit"
      class="btn btn-primary w-100 mt-2"
      [disabled]="loading || profileForm.pristine"
    >
      <span *ngIf="loading" class="spinner"></span>
      {{ loading ? 'Saving...' : 'Save Changes' }}
    </button>
  </form>

  <!-- Password section (handled separately) -->
  <div class="field-group mt-4 mb-3">
    <label for="password">New Password</label>
    <input
      id="password"
      name="newPassword"
      type="password"
      [(ngModel)]="newPassword"
      class="input"
      placeholder="••••••••"
      [disabled]="loading"
    />
    <button
      type="button"
      class="btn btn-warning mt-2 w-100"
      (click)="changePassword()"
      [disabled]="loading || !newPassword"
    >
      {{ loading ? 'Updating...' : 'Change Password' }}
    </button>
  </div>
</div>
